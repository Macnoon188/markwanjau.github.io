<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monitoring pfSense with Wazuh ‚Äì Homelab Guide</title>

  <link rel="stylesheet" href="styles.css" />
  <script src="matrix.js" defer></script>
</head>

<body>

<canvas id="matrix-canvas"></canvas>

<nav class="nav-bar">
  <ul class="nav-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="projects.html">Projects</a></li>
    <li><a href="blogs.html">Blogs</a></li>

    <li class="dropdown">
      <a href="#">Career ‚ñæ</a>
      <ul class="dropdown-menu">
        <li><a href="career-ku.html">Kenyatta University</a></li>
        <li><a href="career-deckfirm.html">Deckfirm Technologies</a></li>
      </ul>
    </li>

    <li><a href="education.html">Education & Certs</a></li>
  </ul>
</nav>

<main class="content-wrapper">

  <article class="mag-article">

    <!-- HERO -->
    <header class="mag-hero">
      <p class="mag-kicker">Week 2 ‚Äì Cybersecurity Homelab Series</p>

      <h1 class="mag-title">
        Monitoring pfSense with Wazuh: A Step-by-Step Guide for My Homelab
      </h1>

      <p class="mag-subtitle">
        How I integrated my firewall with Wazuh SIEM to gain real-time network visibility
      </p>

      <div class="mag-meta">
        Published: Week 2, Tuesday ‚Ä¢ Author: Jonathan Kirui ‚Ä¢ Tags: Wazuh ‚Ä¢ pfSense ‚Ä¢ SIEM ‚Ä¢ Cybersecurity ‚Ä¢ Monitoring
      </div>
    </header>

    <!-- LEAD -->
    <section class="mag-lead">
      <p>
        When I first integrated pfSense into my homelab, I realized that while it‚Äôs a powerful firewall, it needed centralized monitoring to
        fully understand what was happening at the network perimeter. Since I already run Wazuh 4.5 for endpoint monitoring,
        connecting pfSense logs to my SIEM was the logical next step. This guide explains how I did it and the benefits I gained.
      </p>
    </section>

    <!-- WHY -->
    <section class="mag-section">
      <h2>üîí Why Monitor pfSense with Wazuh?</h2>
      <p>
        pfSense is the gatekeeper of your homelab. Feeding its logs into Wazuh gives:
        <br>‚Ä¢ Real-time firewall event visibility
        <br>‚Ä¢ Insight into blocked connections, scans & VPN events
        <br>‚Ä¢ Correlation between firewall + endpoint alerts
        <br>‚Ä¢ A single SIEM dashboard for your entire lab
        <br><br>
        This turns a basic homelab into a lightweight SOC training environment ‚Äî perfect for blue-team learning.
      </p>
    </section>

    <!-- SETUP -->
    <section class="mag-section">
      <h2>üèóÔ∏è My Homelab Setup</h2>
      <p>
        ‚Ä¢ Firewall: pfSense CE (dedicated hardware)<br>
        ‚Ä¢ SIEM: Wazuh 4.5 on Ubuntu (Proxmox LXC)<br>
        ‚Ä¢ Log Transport: Syslog (UDP/TCP)<br>
        ‚Ä¢ Wazuh Module: Logcollector<br><br>
        Before starting, ensure Wazuh Manager can reach pfSense over LAN.
      </p>
    </section>

    <!-- STEPS -->
    <section class="mag-section">
      <h2>üîß Step-by-Step Integration</h2>

      <h3>Step 1 ‚Äî Enable Remote Logging</h3>
      <p>
        pfSense ‚Üí Status ‚Üí System Logs ‚Üí Settings ‚Üí Remote Logging Options<br>
        Enable & add your Wazuh Manager:
        <br>192.168.x.x:514
        <br>Select logs:
        <br>‚Ä¢ System ‚Ä¢ Firewall ‚Ä¢ DHCP ‚Ä¢ VPN ‚Ä¢ DNS Resolver
      </p>

      <h3>Step 2 ‚Äî Configure Wazuh</h3>
      <p class="callout">
        File: /var/ossec/etc/ossec.conf<br><br>
        &lt;remote&gt;<br>
        &nbsp;&nbsp;&lt;connection&gt;syslog&lt;/connection&gt;<br>
        &nbsp;&nbsp;&lt;port&gt;514&lt;/port&gt;<br>
        &nbsp;&nbsp;&lt;protocol&gt;udp&lt;/protocol&gt;<br>
        &nbsp;&nbsp;&lt;allowed-ips&gt;192.168.0.0/24&lt;/allowed-ips&gt;<br>
        &lt;/remote&gt;
      </p>
      <p>Restart Wazuh:</p>
      <p class="callout">sudo systemctl restart wazuh-manager</p>

      <h3>Step 3 ‚Äî Optional: Apply Parsing Rules</h3>
      <p class="callout">
        File: /var/ossec/etc/rules/pfsense_rules.xml<br><br>
        &lt;group name="pfsense,"&gt;<br>
        &nbsp;&nbsp;&lt;rule id="700001" level="5"&gt;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;decoded_as&gt;syslog&lt;/decoded_as&gt;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;match&gt;filterlog:&lt;/match&gt;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;pfSense Firewall Event&lt;/description&gt;<br>
        &nbsp;&nbsp;&lt;/rule&gt;<br>
        &lt;/group&gt;
      </p>

      <p>Restart again:</p>
      <p class="callout">sudo systemctl restart wazuh-manager</p>
    </section>

    <!-- VERIFY -->
    <section class="mag-section">
      <h2>üìä Verifying Logs</h2>
      <p>
        In Wazuh Dashboard ‚Üí Security Events, filter by:
        <br>‚Ä¢ pfSense Source IP
        <br>‚Ä¢ Rule group ‚Äúpfsense‚Äù
        <br><br>
        You should see:
        <br>‚Ä¢ Blocked inbound traffic
        <br>‚Ä¢ DHCP leases
        <br>‚Ä¢ VPN events
        <br>‚Ä¢ DNS resolver logs
        <br>‚Ä¢ Port scan detections
      </p>
    </section>

    <!-- WHAT I MONITOR -->
    <section class="mag-section">
      <h2>üîç What I Monitor</h2>
      <p>
        ‚Ä¢ Firewall events ‚Üí intrusion attempts<br>
        ‚Ä¢ DHCP ‚Üí new / rogue devices<br>
        ‚Ä¢ VPN logs ‚Üí access monitoring<br>
        ‚Ä¢ DNS ‚Üí suspicious domains<br>
        ‚Ä¢ System logs ‚Üí reboots & interface issues
      </p>
    </section>

    <!-- BENEFITS -->
    <section class="mag-section">
      <h2>üéØ Key Benefits Gained</h2>
      <p>
        ‚Ä¢ Better correlation between network & host threats<br>
        ‚Ä¢ Full visibility into WAN attacks<br>
        ‚Ä¢ Real-world SIEM + firewall experience<br>
        ‚Ä¢ Stronger lab security posture
      </p>
    </section>

    <footer class="mag-footer">
      <p>Want more homelab security guides? Keep following this series!</p>
    </footer>

  </article>

</main>

<footer>
  <p>&copy; 2025 Mark Andrew Wanjau | Built by Makbuilt Solutions</p>
</footer>

</body>
</html>